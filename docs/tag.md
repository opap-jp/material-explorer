# タグ

## 概要

**タグ**（*tag*）は、簡潔な自然言語で記述される、**素材**（*material*）の特徴を説明するものです。タグは特徴による素材の検索を実現します。

一つの素材には0個以上のタグが設定され、一つのタグは0個以上の素材に設定されます。

Material Explorer のユーザーは、検索においてタグを使用することができます。
検索条件としてタグを指定することで、そのタグが設定された素材のリストを取得できます。

タグの例としては、`こうしす！第1話`，`井二 かける`，`祝園 アカネ` などがあります。

## 素材に対するタグの設定

タグは、あらかじめ**マニフェスト**（*manifest*）において宣言されなければなりません。マニフェストで宣言されたタグは**宣言済みタグ**（*declared tag*）として**タグ定義**（*tag definitions*）に追加されます。タグ定義は、システム全体に存在するタグの集合です。

素材に対してタグを設定するには、その素材に対応する**メタデータファイル**（*metadata file*）でそのタグの名称を記述します。

素材に対して宣言されていないタグの設定が試みられると、そのタグは特殊なタグ，**未宣言タグ**（*undeclared tag*）としてタグ定義に追加され、未宣言タグが存在していることを示す警告が登録されます。

## 形式

タグを構成する、自然言語による記述をタグの**名称**（*name*）といいます。また、複数の古い名称を別の名称で上書きして総称するために用いる特殊な名称を、**総称置換子**（*generic replacement*）といいます。

タグは、0個以上の名称を持ち、たかだか1個の総称置換子を持ちます。
また、名称と総称置換子の合計は最低でも1でなければなりません。

タグの例としては、名称として `[祝園 アカネ, アカネ]` を持つものなどがあります。

### 種別とグループ

タグの**種別**（*kind*）は、そのタグがどのように定義・設定されるかを示すものです。
種別はアプリケーションで完全に定義されており、ユーザーが追加することはできません。3個の種別があります。

|名称                  |一意  |グループ名|説明                                                                          |
|:---------------------|:-----|:---------|:-----------------------------------------------------------------------------|
|普通（`common`）      |いいえ|必要      |マニフェストで定義され、メタデータで設定されるタグ。                          |
|作成者（`author`）    |はい  |不要      |マニフェストで定義され、メタデータで設定されたり自動的に設定されたりするタグ。|
|未宣言（`undeclared`）|はい  |不要      |マニフェストで定義されていないタグの設定が試みられたときに定義されるタグ。    |

タグの**グループ**（*group*）は、グループ化されたタグのリストです。ユーザーは、意味に応じてタグをグループ化して宣言しなければなりません。

一つのグループは、一つの種別を持ちます。一つの種別には0個以上のグループが属します。ただし、**一意**（*unique*）であるカテゴリは、属するグループがたかだか1個でなければなりません。また、カテゴリによっては、グループに名前が必要です。

一つのタグは、一つのグループに属します。一つのグループには0個以上のタグが属します。

グループの例としては、`作成者`，`リポジトリ`，`人物` などがあります。

### 正規化

多少の表記ゆれの許容のため、タグは**正規化**（*normalize*）されます。正規化は、実際には次のことが行なわれます。

1. 半角スペースと全角スペースが削除されます。
1. 全角英数は半角英数に変換されます。
1. カタカナはひらがなに変換されます。
1. 大文字は小文字に変換されます。

たとえば、`祝園 アカネ` は `祝園あかね` に変換されます。
